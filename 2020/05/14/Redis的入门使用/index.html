<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Redis的入门使用 | Blog</title><meta name="keywords" content="Java,Redis"><meta name="author" content="YANG"><meta name="copyright" content="YANG"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="0、Redis  REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。 它通常被称为数据结构服务器，因为值（value）可以是 字符串(String),">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis的入门使用">
<meta property="og:url" content="http://www.yanghuisen.cn/2020/05/14/Redis%E7%9A%84%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8/index.html">
<meta property="og:site_name" content="Blog">
<meta property="og:description" content="0、Redis  REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。 Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。 它通常被称为数据结构服务器，因为值（value）可以是 字符串(String),">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://www.yanghuisen.cn/img/index_img2.jpg">
<meta property="article:published_time" content="2020-05-14T13:59:06.000Z">
<meta property="article:modified_time" content="2023-05-23T08:33:00.953Z">
<meta property="article:author" content="YANG">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Redis">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.yanghuisen.cn/img/index_img2.jpg"><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="http://www.yanghuisen.cn/2020/05/14/Redis%E7%9A%84%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: YANG","link":"链接: ","source":"来源: Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Redis的入门使用',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-05-23 16:33:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/index_img2.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Redis的入门使用</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-05-14T13:59:06.000Z" title="发表于 2020-05-14 21:59:06">2020-05-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-05-23T08:33:00.953Z" title="更新于 2023-05-23 16:33:00">2023-05-23</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Redis的入门使用"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="0、Redis"><a href="#0、Redis" class="headerlink" title="0、Redis"></a>0、Redis</h1><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9ia2ltZy5jZG4uYmNlYm9zLmNvbS9waWMvYWVjMzc5MzEwYTU1YjMxOTEzOWNiNjcxNDFhOTgyMjZjZmZjMTc0OA?x-oss-process=image/format,png"></p>
<blockquote>
<p>REmote DIctionary Server(Redis) 是一个由Salvatore Sanfilippo写的key-value存储系统。</p>
<p>Redis是一个开源的使用ANSI C语言编写、遵守BSD协议、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。</p>
<p>它通常被称为数据结构服务器，因为值（value）可以是 字符串(String), 哈希(Hash), 列表(list), 集合(sets) 和 有序集合(sorted sets)等类型。</p>
</blockquote>
<p>Redis 是完全<strong>开源</strong>免费的，遵守BSD协议，是一个高性能的<strong>key-value数据库</strong>。</p>
<p><strong>Redis 与其他 key - value 缓存产品有以下三个特点：</strong></p>
<ul>
<li>Redis支持数据的持久化，可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用。</li>
<li>Redis不仅仅支持简单的key-value类型的数据，同时还提供list，set，zset，hash等数据结构的存储。</li>
<li>Redis支持数据的备份，即master-slave模式的数据备份。</li>
</ul>
<p><strong>Redis的优势：</strong></p>
<ul>
<li>性能极高 – Redis能读的速度是110000次/s,写的速度是81000次/s 。</li>
<li>丰富的数据类型 – Redis支持二进制案例的 Strings, Lists, Hashes, Sets 及 Ordered Sets 数据类型操作。</li>
<li>原子 – Redis的所有操作都是原子性的，意思就是要么成功执行要么失败完全不执行。单个操作是原子性的。多个操作也支持事务，即原子性，通过MULTI和EXEC指令包起来。</li>
<li>丰富的特性 – Redis还支持 publish/subscribe, 通知, key 过期等等特性。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://redis.io/">官网：https://redis.io/</a></p>
<p><a target="_blank" rel="noopener" href="http://www.redis.cn/">中文官网：http://www.redis.cn/</a></p>
<h1 id="1、Linux下的Redis的安装"><a href="#1、Linux下的Redis的安装" class="headerlink" title="1、Linux下的Redis的安装"></a>1、Linux下的Redis的安装</h1><h2 id="1-1、下载"><a href="#1-1、下载" class="headerlink" title="1.1、下载"></a>1.1、下载</h2><p><a target="_blank" rel="noopener" href="https://redis.io/download">下载地址：https://redis.io/download</a></p>
<p>或者</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-5.0.3.tar.gz</span><br></pre></td></tr></table></figure>

<h2 id="1-2、上传文件到服务器"><a href="#1-2、上传文件到服务器" class="headerlink" title="1.2、上传文件到服务器"></a>1.2、上传文件到服务器</h2><p>如果是直接使用wget下载的就不用再上传</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z0UjA1U0tnV1VUem84VWU5UHV3VzRPTWpoTFk?x-oss-process=image/format,png"></p>
<h2 id="1-3、解压文件"><a href="#1-3、解压文件" class="headerlink" title="1.3、解压文件"></a>1.3、解压文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf redis-5.0.3.tar.gz</span><br></pre></td></tr></table></figure>

<p>解压后目录</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z1WmpOM0I1SkdyNkhWd2lzZ2xUUUhUSVYxN2o?x-oss-process=image/format,png"></p>
<h2 id="1-4、安装依赖"><a href="#1-4、安装依赖" class="headerlink" title="1.4、安装依赖"></a>1.4、安装依赖</h2><blockquote>
<p>redis 是基于C++开发的，所有要安装C++的环境</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc-c++ autoconf automake</span><br></pre></td></tr></table></figure>

<h2 id="1-5、预编译"><a href="#1-5、预编译" class="headerlink" title="1.5、预编译"></a>1.5、预编译</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd redis-5.0.3 # 进入redis目录</span><br><span class="line">make # 预编译</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZwN3oyZmJfN1daNUFyVm1iNGlvY1lYek5BQm8?x-oss-process=image/format,png"></p>
<h2 id="1-6、安装"><a href="#1-6、安装" class="headerlink" title="1.6、安装"></a>1.6、安装</h2><p>创建一个安装目录，不然会安装到一个默认路径，后期路径不好找</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/local/redis</span><br></pre></td></tr></table></figure>

<ul>
<li>-p：级联创建，上级目录不存在也一同创建</li>
</ul>
<p>安装到指定路径</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make PREFIX=/usr/local/redis/ install</span><br></pre></td></tr></table></figure>

<ul>
<li>PREFIX：指定要安装的路径</li>
</ul>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZrV0o2d09JcDhtbHJ3Rm5EenFQaWFvTExyNGk?x-oss-process=image/format,png"></p>
<ul>
<li><strong>Redis-cli</strong>：客户端</li>
<li><strong>Redis-server</strong>：服务器端</li>
</ul>
<h2 id="1-7、前台启动"><a href="#1-7、前台启动" class="headerlink" title="1.7、前台启动"></a>1.7、前台启动</h2><p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZzOUNMUTZUV2hYZnd5V1o2UG94VVdZOTZNUjQ?x-oss-process=image/format,png"></p>
<p>默认就是前台启动，但是前台启动有一个不好的地方，就是Redis会一致占用前台输入，无法进行别的从操作。这是为了方便就需要把Redis设置为后台启动，让它在后台运行，不耽误前台进行别的操作。</p>
<h2 id="1-8、后台启动"><a href="#1-8、后台启动" class="headerlink" title="1.8、后台启动"></a>1.8、后台启动</h2><p>1、ctrl+c，结束前台程序运行</p>
<p>2、复制解压的redis目录下的redis.conf文件到安装的路径</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /root/redis-5.0.3/redis.conf /usr/local/redis/bin</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZtWnhzek1keDAwM244RlVKaFlUTjRwVjlJMUM?x-oss-process=image/format,png"></p>
<p>3、修改bin目录下的redis.conf文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim redis.conf</span><br></pre></td></tr></table></figure>

<p>修改<code>daemonize on</code> 为 <code>daemonize yes</code></p>
<p>4、再次运行查看</p>
<p>再次启动程序，需要戴胜redis.conf文件，否则还是前台运行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./redis-server redis.conf	# 启动程序</span><br><span class="line">ps -ef |grep redis # 查看和redis相关的进程</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZpNnRZaHctOEw4U0lydlBBU2t5Mjh6TEotUzg?x-oss-process=image/format,png"></p>
<p>5、后台进程关闭</p>
<p>前台启动的话只需要ctrl+c就可以关闭，但是后台启动相比就麻烦了点，需要直接关闭进程</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kill -9 5977</span><br></pre></td></tr></table></figure>

<p>5977：进程号</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZzYWF0ZEREUjFYVmhPbnR0aWYtT3l6RWtHVV8?x-oss-process=image/format,png"></p>
<h1 id="2、windows客户端方法Redis"><a href="#2、windows客户端方法Redis" class="headerlink" title="2、windows客户端方法Redis"></a>2、windows客户端方法Redis</h1><h2 id="2-1、安装客户端软件"><a href="#2-1、安装客户端软件" class="headerlink" title="2.1、安装客户端软件"></a>2.1、安装客户端软件</h2><p><a target="_blank" rel="noopener" href="https://lanzous.com/ickc0yd">下载地址：https://lanzous.com/ickc0yd</a></p>
<p>常规安装，选择安装路径，下一步就可以了</p>
<h2 id="2-2、配置服务器端Redis程序"><a href="#2-2、配置服务器端Redis程序" class="headerlink" title="2.2、配置服务器端Redis程序"></a>2.2、配置服务器端Redis程序</h2><blockquote>
<p>默认情况下，Redis是不允许别的客户端连接访问的，只能是本机(127.0.0.1)访问，需要设置一下，否则windows客户端连接不上redis</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim redis.conf</span><br></pre></td></tr></table></figure>

<p>1、注释掉<code>bind 127.0.0.1</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">bind</span> 127.0.0.1</span></span><br></pre></td></tr></table></figure>

<p>如果注释掉bind就表示可以是任何ip访问，如果是想要指定的IP访问，直接在127.0.0.1 后添加指定IP就可以</p>
<p>2、关闭保护模式，设置protected-mode为no，否则依然无法连接</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protected-mode no</span><br></pre></td></tr></table></figure>

<p>3、设置访问认证(密码)</p>
<p>默认状态下是没有开启认证的，需要手动取消<code>#</code>注释(该命令大概在500行左右)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requirepass root</span><br></pre></td></tr></table></figure>

<p>4、保存退出，结束进程，重新启动redis</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-server redis.conf</span><br></pre></td></tr></table></figure>

<h2 id="2-3、windows客户端连接redis"><a href="#2-3、windows客户端连接redis" class="headerlink" title="2.3、windows客户端连接redis"></a>2.3、windows客户端连接redis</h2><p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZoSEpmZEk1TEIzM0tfSktlQmZ2YV9ZY3Q1ZXo?x-oss-process=image/format,png"></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZoZDBFc2lNSnpaUTExb3NOUHUxMW1zTE9oNno?x-oss-process=image/format,png"></p>
<h1 id="3、Redis-cli连接操作Redis"><a href="#3、Redis-cli连接操作Redis" class="headerlink" title="3、Redis-cli连接操作Redis"></a>3、Redis-cli连接操作Redis</h1><blockquote>
<p>Redis-cli就是Redis自带的一个客户端程序，可以用来操作Redis，在安装的路径里</p>
</blockquote>
<h2 id="3-1、redis-clid连接redis"><a href="#3-1、redis-clid连接redis" class="headerlink" title="3.1、redis-clid连接redis"></a>3.1、redis-clid连接redis</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-cli -p 6379 -a root</span><br></pre></td></tr></table></figure>

<ul>
<li>6379：redis的默认端口</li>
<li>root：认证密码</li>
</ul>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZxbDB6cGxlVnFoa3c3Ri1mNG1TTnVGZ0pkM3U?x-oss-process=image/format,png"></p>
<h2 id="3-2、操作redis"><a href="#3-2、操作redis" class="headerlink" title="3.2、操作redis"></a>3.2、操作redis</h2><h3 id="3-2-1、String类型"><a href="#3-2-1、String类型" class="headerlink" title="3.2.1、String类型"></a>3.2.1、String类型</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set name zhangsan	# 添加一个名为name的String类型数据，值为zhangsan</span><br><span class="line">get name			# 获取名为name的String类型数据</span><br><span class="line">mset age 18 addr henan # 批量添加String类型数据</span><br><span class="line">mget age addr		# 批量获取String类型数据，获取名为age和addr的数据</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z1QWRPajhFV0h0aFRmeE1TbnVCYTJBU01iNmw?x-oss-process=image/format,png"></p>
<h3 id="3-2-2、Hash类型"><a href="#3-2-2、Hash类型" class="headerlink" title="3.2.2、Hash类型"></a>3.2.2、Hash类型</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hset userInfo name list # 添加一个名为UserInfo的hash类型，其中一个名是name，值为list</span><br><span class="line">hget userInfo name # 获取名为name的数据</span><br><span class="line">hmset userInfo age 18 addr henan # 添加多条数据</span><br><span class="line">hmget userInfo age addr # 获取多个数据</span><br><span class="line">hgetall userInfo # 获取全部数据</span><br><span class="line">hdel userInfo addr # 删除指定数据</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z2bEVLM3pnRFdteFdmUjBIU1M5VGRfOEE2SzU?x-oss-process=image/format,png"></p>
<h3 id="3-2-3、List类型"><a href="#3-2-3、List类型" class="headerlink" title="3.2.3、List类型"></a>3.2.3、List类型</h3><blockquote>
<p>这里的List类型比较特殊，分为左右两种，一种是从左边添加，一种是从右边添加。左边添加就类似于一种压栈效果，先进的排到后面，右边添加就是常规的追加。</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lpush students zhangsan lisi # 左边添加</span><br><span class="line">lrange students 0 2	# 遍历list，0起始索引，2结束索引</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZnbzdYZnFDVGFCdlhVV0FwTVNmelBPUzNTRmU?x-oss-process=image/format,png"></p>
<p>可以看到zhangsan排在了后面，而lisi排在前面，类似于一个压栈的效果</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpush students wangwu zhaoliu # 右边添加</span><br><span class="line">lrange students 0 8	# 遍历，结束索引可以是一个比list长度大的数字</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZyZS1RcDlHNjhGYmY5elluZXhjbFE1QkdvWnk?x-oss-process=image/format,png"></p>
<p>可以看到，右边添加wangwu在zhaoliu前边，就是一个追加的效果</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">llen students #查看长度</span><br><span class="line">lrem students 1 lisi # 删除指定数量的指定元素</span><br></pre></td></tr></table></figure>

<ul>
<li>lrem students 1 lisi：删除students中的1个lisi</li>
</ul>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZrMVplTHRSVGRpS21nOUlDbkVJNGNDOW82MzU?x-oss-process=image/format,png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lpop students # 移除左边开始的第一个元素</span><br><span class="line">rpop students # 移除右边开始的第一个元素</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZwZ295Z0x4QnJVRFZfaE5yYS04QWctM1BpWmE?x-oss-process=image/format,png"></p>
<h3 id="3-2-4、Set类型"><a href="#3-2-4、Set类型" class="headerlink" title="3.2.4、Set类型"></a>3.2.4、Set类型</h3><blockquote>
<p>这里的set类型和java的一样，无序，不重复</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sadd letters aaa bbb ccc ddd # 添加set类型数据</span><br><span class="line">smembers letters	# 查看set类型数据</span><br><span class="line">scard letters		# 获取set类型数据条数</span><br><span class="line">srem letters aaa ccc	# 删除set类型里的指定元素</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZyazB5ZVdhN2prX283RWQ5RmNKQkxGZmFLMWM?x-oss-process=image/format,png"></p>
<h3 id="3-2-5、Sorted-Set类型"><a href="#3-2-5、Sorted-Set类型" class="headerlink" title="3.2.5、Sorted Set类型"></a>3.2.5、Sorted Set类型</h3><blockquote>
<p>一个有序的Set类型</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">zadd score 5 zhangsan 6 lisi 3 wangwu 9 zhaoliuclear # 添加参数，数值代表等级，数值越低，排名越靠前</span><br><span class="line">zrange score  0 8	# 遍历数据</span><br><span class="line">zcard score		# 数据元素条数</span><br><span class="line">zrem score lisi # 删除指定元素</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZuaDFvQ1dIb0FpQ2g1akFkS2VPSnFmSGpPSUk?x-oss-process=image/format,png"></p>
<h3 id="3-2-6、层级关系-目录结构存储数据"><a href="#3-2-6、层级关系-目录结构存储数据" class="headerlink" title="3.2.6、层级关系|目录结构存储数据"></a>3.2.6、层级关系|目录结构存储数据</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mset user:01 ahh # 以层级关系存储数据,:分割层级</span><br><span class="line">mget user:01 # 以层级关系查找数据，：分割层级</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZtMmJTWWNjZklCODBPaVNqakllUDllSlNPaXA?x-oss-process=image/format,png"></p>
<h3 id="3-2-7、设置Key的失效时间"><a href="#3-2-7、设置Key的失效时间" class="headerlink" title="3.2.7、设置Key的失效时间"></a>3.2.7、设置Key的失效时间</h3><p>有几种不同的命令可以设置失效时间</p>
<p>方式一：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set code test ex 10 # 10秒后失效</span><br></pre></td></tr></table></figure>

<p>方式二：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set code test # 添加数据</span><br><span class="line">expire code 10 # 设置10秒后失效</span><br></pre></td></tr></table></figure>

<ul>
<li>expire：秒</li>
<li>pexpire：毫秒</li>
<li>expireat：秒的时间戳</li>
<li>pexpireat：毫秒的时间戳</li>
</ul>
<p>方式三：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set code test nx ex 10 # code存在时才设置失效时间</span><br></pre></td></tr></table></figure>

<ul>
<li>code：key</li>
<li>test：value</li>
<li>nx：不存在时设置时间，还有一个可选值<code>xx</code>，存在时设置失效时间</li>
<li>ex：秒[px：毫秒]</li>
</ul>
<h3 id="3-2-8、删除"><a href="#3-2-8、删除" class="headerlink" title="3.2.8、删除"></a>3.2.8、删除</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set code test # 添加数据</span><br><span class="line">del code # 删除数据</span><br></pre></td></tr></table></figure>

<h1 id="4、Redis持久化储存"><a href="#4、Redis持久化储存" class="headerlink" title="4、Redis持久化储存"></a>4、Redis持久化储存</h1><blockquote>
<p>Redis是内存中的数据结构储存系统，不是直接存储在磁盘上的，所有就有可能会在机器宕机的时候无法有效的储存数据，所以就需要持久化储存。</p>
<p>Redis有三种方式可以用于持久化储存数据</p>
</blockquote>
<h2 id="4-1、bgsave"><a href="#4-1、bgsave" class="headerlink" title="4.1、bgsave"></a>4.1、bgsave</h2><p>使用bgsave手动持久化储存数据</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set test test</span><br><span class="line">bgsave</span><br></pre></td></tr></table></figure>

<p>这种方式后进行持久化操作很方便，但是很麻烦，需要重复多个的执行<code>bgsave</code>命令</p>
<h2 id="4-2、save配置"><a href="#4-2、save配置" class="headerlink" title="4.2、save配置"></a>4.2、save配置</h2><p>Redis还自带了一种save的持久化储存方式，这是一种自动化的储存方式（默认开启）。可以在redis.conf文件中看到(大概220行左右)，这种方式会在指定时间内，进行自动保存</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZqbzZtazExTGhpdXpFN3BjZGtybVUtS09sa3c?x-oss-process=image/format,png"></p>
<p>默认配置如图，表示在</p>
<p>900秒内，有一个key被改动，则在900秒后被自动持久化保存</p>
<p>300秒内，有10个key被改动，则在300秒后被自动持久化保存</p>
<p>60秒内，有10000个key被改动，则在60秒后被自动持久化保存</p>
<p>但是这种情况也不是很完善，比如在60秒内有10000的数据被改动，但是在58秒的时候机器断电了，不到低60秒，它也不会自动持久化储存。</p>
<h2 id="4-3、appendonly"><a href="#4-3、appendonly" class="headerlink" title="4.3、appendonly"></a>4.3、appendonly</h2><p>默认情况就该配置是关闭的，需要手动开启，设置on为yes(redis.conf文件的大概700行左右)，该配置开启后会自动关闭上面的save持久化方式。该方式的特点就是会保存写过的所有的命令，会把所有的命令保存到一个appendonly.aof文件中，每次启动redis都会先执行该文件，以达到持久化储存的效果。</p>
<p>但是这种方式也有弊端，那就是会保存很多没用的代码，后续文件会越来越大，影响redis的运行效果。</p>
<h1 id="5、Java操作Redis"><a href="#5、Java操作Redis" class="headerlink" title="5、Java操作Redis"></a>5、Java操作Redis</h1><h2 id="5-1、创建SpringBoot项目"><a href="#5-1、创建SpringBoot项目" class="headerlink" title="5.1、创建SpringBoot项目"></a>5.1、创建SpringBoot项目</h2><p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZrUlNIUXVHUW1JZ05sbFgxd0JRSTdpOGFFSnM?x-oss-process=image/format,png"></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZvWkJiel8xYW44R2k3MkhHZzNlXzRxS0tHTzM?x-oss-process=image/format,png"></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZudmpQcVVqelZxYUtLMnNDRlFMel9sNUQtZkE?x-oss-process=image/format,png"></p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z0SXIydWtpZmhNUDZWYXFGVE54eHNzRzRsZVA?x-oss-process=image/format,png"></p>
<h2 id="5-2、修改POM配置文件"><a href="#5-2、修改POM配置文件" class="headerlink" title="5.2、修改POM配置文件"></a>5.2、修改POM配置文件</h2><p>1、修改Test依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、修改Redis依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                1.x的版本默认采用的连接池技术是Jedis</span></span><br><span class="line"><span class="comment">                2.x以上版本默认连接时是Lettuce,</span></span><br><span class="line"><span class="comment">                如果要使用Jedis连接池需要排除Lettuce的依赖</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--排除lettuce依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.lettuce<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lettuce-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>3、添加Jedis依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>完整文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.7.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.yanghuisen<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>redisdemo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>redisdemo<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Demo project for Spring Boot<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Redis组件依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                1.x的版本默认采用的连接池技术是Jedis</span></span><br><span class="line"><span class="comment">                2.x以上版本默认连接时是Lettuce,</span></span><br><span class="line"><span class="comment">                如果要使用Jedis连接池需要排除Lettuce的依赖</span></span><br><span class="line"><span class="comment">            --&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--排除lettuce依赖--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.lettuce<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lettuce-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Jedis依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Web--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--test--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="5-3、Jedis的的配置文件"><a href="#5-3、Jedis的的配置文件" class="headerlink" title="5.3、Jedis的的配置文件"></a>5.3、Jedis的的配置文件</h2><p>application.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="comment"># Redis服务器地址</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.10</span><span class="number">.100</span></span><br><span class="line">    <span class="comment"># Redis服务器端口</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">    <span class="comment"># Redis服务器认证密码</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">    <span class="comment"># 要连接的数据库，默认就是0</span></span><br><span class="line">    <span class="attr">database:</span> <span class="number">0</span></span><br><span class="line">    <span class="comment"># 连接超时时间</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="string">10000ms</span></span><br><span class="line">    <span class="attr">jedis:</span></span><br><span class="line">      <span class="attr">pool:</span></span><br><span class="line">        <span class="comment"># 最大连接数，默认是8</span></span><br><span class="line">        <span class="attr">max-active:</span> <span class="number">1024</span></span><br><span class="line">        <span class="comment"># 最大连接组设时间，单位毫秒，默认-1ms</span></span><br><span class="line">        <span class="attr">max-wait:</span> <span class="string">10000ms</span></span><br><span class="line">        <span class="comment"># 最大空闲连接，默认8</span></span><br><span class="line">        <span class="attr">max-idle:</span> <span class="number">200</span></span><br><span class="line">        <span class="comment"># 最小连接，默认0</span></span><br><span class="line">        <span class="attr">min-idle:</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>

<h2 id="5-4、创建连接池配置类"><a href="#5-4、创建连接池配置类" class="headerlink" title="5.4、创建连接池配置类"></a>5.4、创建连接池配置类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.yanghuisen.redisdemo.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPool;</span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.JedisPoolConfig;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> admin</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/13 19:22</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> Jedis配置类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span>  <span class="comment">// 配置类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JedisConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 服务器地址</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.redis.host&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String host;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 服务器端口</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.redis.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer port;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 认证密码</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.redis.password&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 连接超时时间</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.redis.timeout&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String timeout;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 最大链接数</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.redis.jedis.pool.max-active&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer maxActive;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 最大链接数</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.redis.jedis.pool.max-wait&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String maxWait;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 最大空闲连接</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.redis.jedis.pool.max-idle&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer maxIdle;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 最小空闲连接</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.redis.jedis.pool.min-idle&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer minIdle;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JedisPool <span class="title">redisPoolFactory</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 连接池配置类</span></span><br><span class="line">        JedisPoolConfig jedisPoolConfig = <span class="keyword">new</span> JedisPoolConfig();</span><br><span class="line">        <span class="comment">// 设置最大连接阻塞时间</span></span><br><span class="line">        jedisPoolConfig.setMaxWaitMillis(Long.parseLong(maxWait.substring(<span class="number">0</span>,maxWait.length()-<span class="number">2</span>)));</span><br><span class="line">        <span class="comment">// 最大链接数</span></span><br><span class="line">        jedisPoolConfig.setMaxTotal(maxActive);</span><br><span class="line">        <span class="comment">// 最大空闲连接</span></span><br><span class="line">        jedisPoolConfig.setMaxIdle(maxIdle);</span><br><span class="line">        <span class="comment">// 最小空闲连接</span></span><br><span class="line">        jedisPoolConfig.setMinIdle(minIdle);</span><br><span class="line">        <span class="comment">// 连接池，连接池配置类，服务器地址，端口，连接超时时间。认证密码</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JedisPool(jedisPoolConfig,host,port,Integer.parseInt(timeout.substring(<span class="number">0</span>,timeout.length()-<span class="number">2</span>)),password);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="5-5、注入连接池，切入点拦截"><a href="#5-5、注入连接池，切入点拦截" class="headerlink" title="5.5、注入连接池，切入点拦截"></a>5.5、注入连接池，切入点拦截</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> JedisPool jedisPool;</span><br><span class="line"><span class="keyword">private</span> Jedis jedis = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@BeforeEach</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initConn</span><span class="params">()</span></span>&#123;</span><br><span class="line">    jedis = jedisPool.getResource();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@AfterEach</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closeCinn</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">null</span>!=jedis)&#123;</span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-5、操作String"><a href="#5-5、操作String" class="headerlink" title="5.5、操作String"></a>5.5、操作String</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testString</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 添加单条数据</span></span><br><span class="line">    jedis.set(<span class="string">&quot;ahh&quot;</span>,<span class="string">&quot;ahh&quot;</span>);</span><br><span class="line">    jedis.set(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;18&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加多条数据,参数：奇数-key，偶数-value</span></span><br><span class="line">    jedis.mset(<span class="string">&quot;addr&quot;</span>,<span class="string">&quot;henan&quot;</span>,<span class="string">&quot;sex&quot;</span>,<span class="string">&quot;男&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取一条数据</span></span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;ahh&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取多条数据</span></span><br><span class="line">    jedis.mget(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;addr&quot;</span>,<span class="string">&quot;sex&quot;</span>).forEach(System.out::println);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除</span></span><br><span class="line">    jedis.del(<span class="string">&quot;sex&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-6、操作Hash"><a href="#5-6、操作Hash" class="headerlink" title="5.6、操作Hash"></a>5.6、操作Hash</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作Hash</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testHash</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 添加一条数据</span></span><br><span class="line">    jedis.hset(<span class="string">&quot;userInfo&quot;</span>,<span class="string">&quot;name&quot;</span>,<span class="string">&quot;ahh&quot;</span>);</span><br><span class="line">    <span class="comment">// 添加多条数据</span></span><br><span class="line">    Map&lt;String,String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;20&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;sex&quot;</span>,<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    jedis.hmset(<span class="string">&quot;userInfo&quot;</span>,map);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取一条数据</span></span><br><span class="line">    System.out.println(jedis.hget(<span class="string">&quot;userInfo&quot;</span>,<span class="string">&quot;name&quot;</span>));</span><br><span class="line">    <span class="comment">// 获取多条数据</span></span><br><span class="line">    jedis.hmget(<span class="string">&quot;userInfo&quot;</span>,<span class="string">&quot;age&quot;</span>,<span class="string">&quot;sex&quot;</span>).forEach(System.out::println);</span><br><span class="line">    <span class="comment">// 获取Hash类型多有的数据</span></span><br><span class="line">    jedis.hgetAll(<span class="string">&quot;userInfo&quot;</span>).forEach((k, v) -&gt; &#123;</span><br><span class="line">        System.out.println(k+<span class="string">&quot;----&quot;</span>+v);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除</span></span><br><span class="line">    jedis.hdel(<span class="string">&quot;userInfo&quot;</span>,<span class="string">&quot;sex&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-7、操作List"><a href="#5-7、操作List" class="headerlink" title="5.7、操作List"></a>5.7、操作List</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作List</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testList</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 左添加</span></span><br><span class="line">    jedis.lpush(<span class="string">&quot;aabc&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>);</span><br><span class="line">    <span class="comment">// 右添加</span></span><br><span class="line">    jedis.rpush(<span class="string">&quot;aabc&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>);</span><br><span class="line">    <span class="comment">// 获取数据</span></span><br><span class="line">    jedis.lrange(<span class="string">&quot;aabc&quot;</span>,<span class="number">0</span>,<span class="number">10</span>).forEach(System.out::println);</span><br><span class="line">    <span class="comment">// 获取总条数</span></span><br><span class="line">    System.out.println(<span class="string">&quot;总条数：&quot;</span>+jedis.llen(<span class="string">&quot;aabc&quot;</span>));</span><br><span class="line">    <span class="comment">// 删除list元素</span></span><br><span class="line">    jedis.lrem(<span class="string">&quot;aabc&quot;</span>,<span class="number">1</span>,<span class="string">&quot;c&quot;</span>);</span><br><span class="line">    <span class="comment">// 左移除</span></span><br><span class="line">    jedis.lpop(<span class="string">&quot;aabc&quot;</span>);</span><br><span class="line">    <span class="comment">// 右移除</span></span><br><span class="line">    jedis.rpop(<span class="string">&quot;aabc&quot;</span>);</span><br><span class="line">    <span class="comment">// 删除</span></span><br><span class="line">    jedis.del(<span class="string">&quot;aabc&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-8、操作Set"><a href="#5-8、操作Set" class="headerlink" title="5.8、操作Set"></a>5.8、操作Set</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作Set</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testSet</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 添加数据</span></span><br><span class="line">    jedis.sadd(<span class="string">&quot;letters&quot;</span>,<span class="string">&quot;aa&quot;</span>,<span class="string">&quot;bb&quot;</span>,<span class="string">&quot;cc&quot;</span>,<span class="string">&quot;dd&quot;</span>);</span><br><span class="line">    <span class="comment">// 获取数据</span></span><br><span class="line">    jedis.smembers(<span class="string">&quot;letters&quot;</span>).forEach(System.out::println);</span><br><span class="line">    <span class="comment">// 获取条数</span></span><br><span class="line">    System.out.println(<span class="string">&quot;总条数：&quot;</span>+jedis.scard(<span class="string">&quot;letters&quot;</span>));</span><br><span class="line">    <span class="comment">// 删除</span></span><br><span class="line">    jedis.srem(<span class="string">&quot;letters&quot;</span>,<span class="string">&quot;dd&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-9、操作Sorted-Set"><a href="#5-9、操作Sorted-Set" class="headerlink" title="5.9、操作Sorted Set"></a>5.9、操作Sorted Set</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 操作SortedSet</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testSortedSet</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 添加数据</span></span><br><span class="line">    Map&lt;String,Double&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;张三&quot;</span>,<span class="number">5d</span>);</span><br><span class="line">    map.put(<span class="string">&quot;李四&quot;</span>,<span class="number">2d</span>);</span><br><span class="line">    map.put(<span class="string">&quot;王五&quot;</span>,<span class="number">8d</span>);</span><br><span class="line">    map.put(<span class="string">&quot;赵六&quot;</span>,<span class="number">6d</span>);</span><br><span class="line">    jedis.zadd(<span class="string">&quot;students&quot;</span>,map);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取数据</span></span><br><span class="line">    jedis.zrange(<span class="string">&quot;students&quot;</span>,<span class="number">0</span>,<span class="number">8</span>).forEach(System.out::println);</span><br><span class="line">    <span class="comment">// 总条数</span></span><br><span class="line">    System.out.println(<span class="string">&quot;总条数：&quot;</span>+jedis.zcard(<span class="string">&quot;students&quot;</span>));</span><br><span class="line">    <span class="comment">// 删除</span></span><br><span class="line">    jedis.zrem(<span class="string">&quot;students&quot;</span>,<span class="string">&quot;赵六&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-10、层级关系-目录形式存储数据"><a href="#5-10、层级关系-目录形式存储数据" class="headerlink" title="5.10、层级关系|目录形式存储数据"></a>5.10、层级关系|目录形式存储数据</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 层级关系|目录形式存储数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDir</span><span class="params">()</span></span>&#123;</span><br><span class="line">    jedis.set(<span class="string">&quot;users:user:ahh&quot;</span>,<span class="string">&quot;ahh&quot;</span>);</span><br><span class="line">    jedis.set(<span class="string">&quot;users:user:zhangsan&quot;</span>,<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;users:user:ahh&quot;</span>));</span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;users:user:zhangsan&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-11、设置失效时间"><a href="#5-11、设置失效时间" class="headerlink" title="5.11、设置失效时间"></a>5.11、设置失效时间</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置失效时间</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testExpire</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 方法1</span></span><br><span class="line">    jedis.set(<span class="string">&quot;code&quot;</span>,<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    jedis.expire(<span class="string">&quot;code&quot;</span>,<span class="number">10</span>);    <span class="comment">// 10秒</span></span><br><span class="line">    jedis.pexpire(<span class="string">&quot;code&quot;</span>,<span class="number">10000L</span>);    <span class="comment">// 10000毫秒</span></span><br><span class="line">    System.out.println(jedis.ttl(<span class="string">&quot;code&quot;</span>));  <span class="comment">// 获取剩余秒数据</span></span><br><span class="line">    <span class="comment">// 方法2</span></span><br><span class="line">    jedis.setex(<span class="string">&quot;code&quot;</span>,<span class="number">10</span>,<span class="string">&quot;test&quot;</span>);  <span class="comment">// 10秒</span></span><br><span class="line">    jedis.psetex(<span class="string">&quot;code&quot;</span>,<span class="number">10000L</span>,<span class="string">&quot;test&quot;</span>);  <span class="comment">// 10000毫秒</span></span><br><span class="line">    System.out.println(jedis.pttl(<span class="string">&quot;code&quot;</span>)); <span class="comment">// 获取剩余毫秒</span></span><br><span class="line">    <span class="comment">// 方法3</span></span><br><span class="line">    SetParams setParams = <span class="keyword">new</span> SetParams();</span><br><span class="line">    <span class="comment">// 不存在时</span></span><br><span class="line">    <span class="comment">//        setParams.nx();</span></span><br><span class="line">    <span class="comment">// 存在时</span></span><br><span class="line">    setParams.xx();</span><br><span class="line">    <span class="comment">// 设置失效时间-秒</span></span><br><span class="line">    <span class="comment">//        setParams.ex(10);</span></span><br><span class="line">    <span class="comment">// 设置失效时间-毫秒</span></span><br><span class="line">    setParams.px(<span class="number">10000L</span>);</span><br><span class="line">    jedis.set(<span class="string">&quot;code&quot;</span>,<span class="string">&quot;test&quot;</span>,setParams);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-12、获取所有的key"><a href="#5-12、获取所有的key" class="headerlink" title="5.12、获取所有的key"></a>5.12、获取所有的key</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取所有的key</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testKeyAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 获取key的数量</span></span><br><span class="line">    System.out.println(jedis.dbSize());</span><br><span class="line">    <span class="comment">// 获取所有的key</span></span><br><span class="line">    jedis.keys(<span class="string">&quot;*&quot;</span>).forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-13、删除"><a href="#5-13、删除" class="headerlink" title="5.13、删除"></a>5.13、删除</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 删除</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testDel</span><span class="params">()</span></span>&#123;</span><br><span class="line">    jedis.del(<span class="string">&quot;userInfo&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-14、事务"><a href="#5-14、事务" class="headerlink" title="5.14、事务"></a>5.14、事务</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 事务</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testMulti</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Transaction tx = jedis.multi();</span><br><span class="line">    <span class="comment">// 开启事务</span></span><br><span class="line">    tx.set(<span class="string">&quot;tel&quot;</span>,<span class="string">&quot;1010&quot;</span>);</span><br><span class="line">    <span class="comment">// 提交事务</span></span><br><span class="line">    tx.exec();</span><br><span class="line">    <span class="comment">// 事务回滚</span></span><br><span class="line">    <span class="comment">// tx.discard();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-15、byte序列化"><a href="#5-15、byte序列化" class="headerlink" title="5.15、byte序列化"></a>5.15、byte序列化</h2><p>序列化和反序列化工具</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.yanghuisen.redisdemo.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> admin</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/13 20:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> 序列化和反序列化工具</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializeUtil</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 序列化</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] serialize(Object obj)&#123;</span><br><span class="line">        <span class="comment">// 对象输出流</span></span><br><span class="line">        ObjectOutputStream oos = <span class="keyword">null</span>;</span><br><span class="line">        <span class="comment">// 字节数组输出流</span></span><br><span class="line">        ByteArrayOutputStream baos = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 序列化</span></span><br><span class="line">            baos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">            oos = <span class="keyword">new</span> ObjectOutputStream(baos);</span><br><span class="line">            oos.writeObject(obj);</span><br><span class="line">            <span class="keyword">return</span> baos.toByteArray();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 反序列化</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">unserialize</span><span class="params">(<span class="keyword">byte</span>[] bytes)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span>==bytes)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ByteArrayInputStream bais = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 反序列化</span></span><br><span class="line">            bais = <span class="keyword">new</span> ByteArrayInputStream(bytes);</span><br><span class="line">            ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(bais);</span><br><span class="line">            <span class="keyword">return</span> ois.readObject();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>用户类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.yanghuisen.redisdemo.pojo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> admin</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/13 20:51</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> TODO</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>数据储存和获取</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * byte序列化</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testByte</span><span class="params">()</span></span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setId(<span class="number">1</span>);</span><br><span class="line">    user.setName(<span class="string">&quot;ahh&quot;</span>);</span><br><span class="line">    <span class="comment">// 序列化</span></span><br><span class="line">    <span class="keyword">byte</span>[] userkey = SerializeUtil.serialize(<span class="string">&quot;user:&quot;</span>+user.getId());</span><br><span class="line">    <span class="keyword">byte</span>[] uservalue = SerializeUtil.serialize(user);</span><br><span class="line">    jedis.set(userkey,uservalue);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取数据</span></span><br><span class="line">    <span class="keyword">byte</span>[] values = jedis.get(userkey);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 反序列化</span></span><br><span class="line">    System.out.println(SerializeUtil.unserialize(values));</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="6、Redis搭建主从复用"><a href="#6、Redis搭建主从复用" class="headerlink" title="6、Redis搭建主从复用"></a>6、Redis搭建主从复用</h1><p>单机版的Redis可能会出现一个问题就是，一旦服务器宕机就无法使用，所以Redis有一个主从复用的概念，就是说有一个主服务器和从服务器，主服务器提供写入和读取，从服务器提供取的功能，一旦其中一个从服务器出现了问题，还有其它的从服务区提供使用，一旦主服务器出现了问题，可以把其中的一个从服务器变为主服务器。</p>
<h2 id="6-1、读写分离"><a href="#6-1、读写分离" class="headerlink" title="6.1、读写分离"></a>6.1、读写分离</h2><p>把Redis分为主从关系，一个主服务器，和两个从服务器。</p>
<p>主服务器提供写入和获取，从服务器只提供获取功能。</p>
<p>1、创建三个目录</p>
<ul>
<li>data：数据文件</li>
<li>log：日志文件</li>
<li>conf：配置文件</li>
</ul>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZnTS1GZTVoN3lfSU94ZzlwZVNsdEdJWnBYR2Y?x-oss-process=image/format,png"></p>
<p>2、复制redis.conf配置文件到创建的配置文件目录下</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZzeF9rcnZYMVBLM0tqRE8zbVphNW5NZGVOQzg?x-oss-process=image/format,png"></p>
<p>3、配置配置文件，作为公共配置文件</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Ztb0pUZEluOWpIcTYxczF0dWhFSWNUak1jZG0?x-oss-process=image/format,png"></p>
<p>注释掉bind，运行外界连接</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZrZHVNeHp2bjBuNkdYSzEyUnZBdXVxbmJBcnE?x-oss-process=image/format,png"></p>
<p>关闭保护模式，否则外界无法连接</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZqamgzaVNkVkNFX1g5UjFXYUdkWjN5QXZmeEM?x-oss-process=image/format,png"></p>
<p>注释公共配置端口，后期需要运行三个redis，每个的端口不一样，需要针对每个redis进行私有的配置</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z0ZlZlZ2hteVZfX3NlQlhNYUFMQWtPY0JOZjA?x-oss-process=image/format,png"></p>
<p>修改为后台启动</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZpdHZrQTRaSjg0ZWNIUFdJSlNWT3B3S2lnVGU?x-oss-process=image/format,png"></p>
<p>注释进程编号，三个redis的进程编号都是不一样的，需要针对的进行私有配置</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZrNm1BdjFYZDQyY3Q2ZW03bzBBVkVWemxRMkY?x-oss-process=image/format,png"></p>
<p>注释公共配置日志文件，三个redis有三个日志文件，私有配置</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZoRkJBWHlUd3FlcmljQ3lUR1VVdjZXRDdkcXI?x-oss-process=image/format,png"></p>
<p>注释公共配置数据文件，修改数据文件路径为创建的数据文件路径</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZpWUNacU1iNXFvZS1VNFpRZFJjMDY0c1ljSlo?x-oss-process=image/format,png"></p>
<p>添加从数据库访问主服务器认证密码</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZvTzk0Qk5WZU91ZW1zT29uVUdzcW12VjlMRzI?x-oss-process=image/format,png"></p>
<p>设置访问认证，三个redis的认证密码都是一个，设置为公用的</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZxNWl4VEtXU3AtbXE5YURCclNnMTh2VzJWM20?x-oss-process=image/format,png"></p>
<p>注释公共配置追加文件，这个根据需求选择是否使用，这里关闭</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZpNEthMWx2WUtvNVZ3ajBxQlF1dkM4RFo5cm4?x-oss-process=image/format,png"></p>
<p>设置从服务器只能读取，不能写入</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZvQmRvUTR2OFpwc3VPODV1cFF3SnhFMjNKWjk?x-oss-process=image/format,png"></p>
<p>保存退出</p>
<h2 id="6-2、创建配置三个私有配置文件"><a href="#6-2、创建配置三个私有配置文件" class="headerlink" title="6.2、创建配置三个私有配置文件"></a>6.2、创建配置三个私有配置文件</h2><p>1、创建三个配置文件</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZvWlV0dUpqZmtTRXI2Z01VNkt4OElRTjhVbGk?x-oss-process=image/format,png"></p>
<p><strong>redis-xxxx</strong>：xxxx表示的每个的端口，为了方便区分</p>
<p>2、修改每个的配置文件</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z1U1lRR21RV2ozT2dnLUVnampDZEdaMmlqZFE?x-oss-process=image/format,png"></p>
<p>redis-6379.conf</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 引用公共配置文件</span></span><br><span class="line">include /opt/redis/conf/redis-common.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程编号记录文件</span></span><br><span class="line">pidfile /var/run/redis-6379.pid</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程端口号</span></span><br><span class="line">port 6379</span><br><span class="line"><span class="meta">#</span><span class="bash"> 日志记录文件</span></span><br><span class="line">logfile &quot;/opt/redis/log/redis-6379.log&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 数据记录文件</span></span><br><span class="line">dbfilename dump-6379.rdb</span><br><span class="line"><span class="meta">#</span><span class="bash"> 追加文件名称</span></span><br><span class="line">appendfilename &quot;appendonly-6379.aof&quot;</span><br></pre></td></tr></table></figure>

<p>redis-6380.conf</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 引用公共配置文件</span></span><br><span class="line">include /opt/redis/conf/redis-common.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程编号记录文件</span></span><br><span class="line">pidfile /var/run/redis-6380.pid</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程端口号</span></span><br><span class="line">port 6380</span><br><span class="line"><span class="meta">#</span><span class="bash"> 日志记录文件</span></span><br><span class="line">logfile &quot;/opt/redis/log/redis-6380.log&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 数据记录文件</span></span><br><span class="line">dbfilename dump-6380.rdb</span><br><span class="line"><span class="meta">#</span><span class="bash"> 追加文件名称</span></span><br><span class="line">appendfilename &quot;appendonly-6380.aof&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置主服务器的IP地址</span></span><br><span class="line">slaveof 192.168.10.100 6379</span><br></pre></td></tr></table></figure>

<p>redis-6381.conf</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 引用公共配置文件</span></span><br><span class="line">include /opt/redis/conf/redis-common.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程编号记录文件</span></span><br><span class="line">pidfile /var/run/redis-6381.pid</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程端口号</span></span><br><span class="line">port 6381</span><br><span class="line"><span class="meta">#</span><span class="bash"> 日志记录文件</span></span><br><span class="line">logfile &quot;/opt/redis/log/redis-6381.log&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 数据记录文件</span></span><br><span class="line">dbfilename dump-6381.rdb</span><br><span class="line"><span class="meta">#</span><span class="bash"> 追加文件名称</span></span><br><span class="line">appendfilename &quot;appendonly-6381.aof&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置主服务器的IP地址</span></span><br><span class="line">slaveof 192.168.10.100 6379</span><br></pre></td></tr></table></figure>

<h2 id="6-3、运行三个redis进程，并测试主从"><a href="#6-3、运行三个redis进程，并测试主从" class="headerlink" title="6.3、运行三个redis进程，并测试主从"></a>6.3、运行三个redis进程，并测试主从</h2><p>1、运行三个redis进程</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZtUmhVdkdpbHliZUJJZ0lNUlBfZXdoX05ZVno?x-oss-process=image/format,png"></p>
<p>2、查看每个服务器的主从状态</p>
<p>主服务器</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZwdXZiXzh0aTBZMWpsMFh4MDJPS1owNjBOelo?x-oss-process=image/format,png"></p>
<p>从服务器1</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z2SHZxMVZYWVFEYzVqTkZZdWlNc1M5U3phV0Y?x-oss-process=image/format,png"></p>
<p>从服务器2</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZpTUtEUC1BMWxrRzFSalU3MlNfeFk2a0xYNWU?x-oss-process=image/format,png"></p>
<p>3、测试主服务下添加数据，在从服务器下查询是否正常</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z1ek1pU2FCMkV6Njd4QkRQQl82TVd2cHVKRUc?x-oss-process=image/format,png"></p>
<p>4、从服务器不能写入测试</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z0aHhYS2hIQXd4SGZMY3liUjVjMXhSeERlaEk?x-oss-process=image/format,png"></p>
<h2 id="6-4、主备切换"><a href="#6-4、主备切换" class="headerlink" title="6.4、主备切换"></a>6.4、主备切换</h2><p>上面已经进行了读写分离，完成了主从服务器，但是这时还有一个问题，如果主服务器出现了问题，那么就不能再进行写入操作，只能使用从服务器获取主服务宕机之前的数据，为了解决这一问题，就引入了一个叫做哨兵的方案，通过哨兵，可以检测到主服务是否宕机，如果主服务器宕机了，就会在满足一定的要求后选举一个从服务器变为主服务，如果之前宕机的主服务恢复了，则被宕机的服务变为从服务。以此来解决，主服务宕机后，无法在提供写入操作的问题。</p>
<h3 id="6-4-1、复制哨兵配置文件到创建的配置文件目录下"><a href="#6-4-1、复制哨兵配置文件到创建的配置文件目录下" class="headerlink" title="6.4.1、复制哨兵配置文件到创建的配置文件目录下"></a>6.4.1、复制哨兵配置文件到创建的配置文件目录下</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /root/redis-5.0.3/sentinel.conf /opt/redis/conf/</span><br></pre></td></tr></table></figure>

<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZxaU5VTGctMjZWOWdBTUU5dXhoUmg1VVZNR3Q?x-oss-process=image/format,png"></p>
<h3 id="6-4-2、修改哨兵配置文件"><a href="#6-4-2、修改哨兵配置文件" class="headerlink" title="6.4.2、修改哨兵配置文件"></a>6.4.2、修改哨兵配置文件</h3><p>注释哨兵监听进程端口号</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZzRjVNZm9ndXlDcGFwR0RnR2hpejJ1Q2JBTUc?x-oss-process=image/format,png"></p>
<p>指示哨兵监听一个主服务器，主服务器地址为192.168.10.100，端口为6379，2表示判断失败的要求，配置三个哨兵，一半(3个的一半为1.5，取整为2)以上都监听主服务状态为不达标就更换主服务器</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z2ZkxVOTF6S08xblp3SW9Yci1NcGgwZlBmd28?x-oss-process=image/format,png"></p>
<p>设置密码</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Zta01URmYtdUdXeloyZFRJSDhYUmxJWWQ3Zm4?x-oss-process=image/format,png"></p>
<p>设置哨兵认为服务器断线所需的毫秒数。</p>
<p>默认是30000毫秒，也就是30秒，为了测试改为10000毫秒</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZxenVBSjkwQ05pbnNmWllUbTdmR3p4cV9JeU0?x-oss-process=image/format,png"></p>
<p>设置主服务和从服务器切换时间</p>
<p>默认是3分钟，如果三分钟内没有切换成功，则本次切换失败</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZqVTRvdmFoRHNmRllaaHJScW5uYjcxbTdtWkM?x-oss-process=image/format,png"></p>
<p>关闭哨兵的保护模式</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZtejR2Q0dHWGNxQUY3SnB2VVp1Ny1heFI2WUE?x-oss-process=image/format,png"></p>
<p>修改哨兵为后台启动</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z2ekR2UE9NYjlLaFNWY045TV9BaGxUVjYwdVI?x-oss-process=image/format,png"></p>
<h3 id="6-4-3、添加三个私有哨兵配置文件"><a href="#6-4-3、添加三个私有哨兵配置文件" class="headerlink" title="6.4.3、添加三个私有哨兵配置文件"></a>6.4.3、添加三个私有哨兵配置文件</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z2aHJCZjBicEFJSDR2OHR3QVlOeE5NenFhTEM?x-oss-process=image/format,png"></p>
<p>私有哨兵配置1</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 引用公共配置</span></span><br><span class="line">include /opt/redis/conf/sentinel.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程端口号</span></span><br><span class="line">port 26379</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程编号近路文件</span></span><br><span class="line">pidfile /var/run/sentinel-26379.pid</span><br><span class="line"><span class="meta">#</span><span class="bash"> 日志文件</span></span><br><span class="line">logfile &quot;/opt/redis/log/sentinel-26379.log&quot;</span><br></pre></td></tr></table></figure>

<p>私有哨兵配置2</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 引用公共配置</span></span><br><span class="line">include /opt/redis/conf/sentinel.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程端口号</span></span><br><span class="line">port 26380</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程编号近路文件</span></span><br><span class="line">pidfile /var/run/sentinel-26380.pid</span><br><span class="line"><span class="meta">#</span><span class="bash"> 日志文件</span></span><br><span class="line">logfile &quot;/opt/redis/log/sentinel-26380.log&quot;</span><br></pre></td></tr></table></figure>

<p>私有哨兵配置2</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 引用公共配置</span></span><br><span class="line">include /opt/redis/conf/sentinel.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程端口号</span></span><br><span class="line">port 26381</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进程编号近路文件</span></span><br><span class="line">pidfile /var/run/sentinel-26381.pid</span><br><span class="line"><span class="meta">#</span><span class="bash"> 日志文件</span></span><br><span class="line">logfile &quot;/opt/redis/log/sentinel-26381.log</span><br></pre></td></tr></table></figure>

<h2 id="6-4-4、哨兵启动测试"><a href="#6-4-4、哨兵启动测试" class="headerlink" title="6.4.4、哨兵启动测试"></a>6.4.4、哨兵启动测试</h2><p>1、启动三个哨兵</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZyY2g2Rmo2TE1ZYllRNVZ2NFIxU253dldwUms?x-oss-process=image/format,png"></p>
<p>2、查看主服务器和从服务状态</p>
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-RG5Gs2Gg-1589464617789)(<a target="_blank" rel="noopener" href="http://images.yanghuisen.cn/FitC_MDwSArK5ra8zhbOFGQStflB)]">http://images.yanghuisen.cn/FitC_MDwSArK5ra8zhbOFGQStflB)]</a></p>
<p>3、杀死主服务器，模拟主服务宕机</p>
<p>杀死主服务器后等待10秒，让哨兵选择新的主服务器，并重新启动被杀死的服务器</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0Z2VzFLa2pLTXlSb0NKMFRieG45TUtNcENORHM?x-oss-process=image/format,png"></p>
<p>4、查看哨兵选重新选举后的服务器状态</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZreXpZY01JRFhVV2VqbkZiQkM1dFppNFNjOGw?x-oss-process=image/format,png"></p>
<h1 id="7、SpringDataRedis"><a href="#7、SpringDataRedis" class="headerlink" title="7、SpringDataRedis"></a>7、SpringDataRedis</h1><p>SpringBoot1.X版本默认使用的是jedis作为Redsi的Java客户端，而2.X版本使用的是lettuce作为Redis的Java客户端。</p>
<p><strong>两者的区别为：</strong></p>
<ul>
<li>Jedis：在实现上直接连接的Redis-Server，在多个线程间共享一个Jedis实例。线程不安全。如果要在多线程的场景下使用Jedis，需要使用连接池，每个线程都使用自己的Jedis实例，当连接数量增多时，会小号大量的物理资源。</li>
<li>lettuce：基于Netty的连接，是一个可伸缩的线程安全的Redis客户端，支持同步、一步和响应式模式。多个线程可以共享一个连接实例，而不必安全多线程并发的问题。它基于NettyNIO框架构建，支持redis的高级功能，如Sentinel（哨兵）、集群、流水线、自动连接和Redis数据模型。</li>
</ul>
<h2 id="7-1、创建SpringBoot项目"><a href="#7-1、创建SpringBoot项目" class="headerlink" title="7.1、创建SpringBoot项目"></a>7.1、创建SpringBoot项目</h2><p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlcy55YW5naHVpc2VuLmNuL0ZsR08yMkQtbjNJQmEzZjl2ZElyRmZ6X3VlU1o?x-oss-process=image/format,png"></p>
<h2 id="7-2、添加依赖"><a href="#7-2、添加依赖" class="headerlink" title="7.2、添加依赖"></a>7.2、添加依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--Spring Data Redis依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--Commons-pool2对象池依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--SpringWeb--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--SpringBootTest--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="7-3、添加application-yml配置文件"><a href="#7-3、添加application-yml配置文件" class="headerlink" title="7.3、添加application.yml配置文件"></a>7.3、添加application.yml配置文件</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="comment"># Redis服务器地址</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.10</span><span class="number">.100</span></span><br><span class="line">    <span class="comment"># Redis服务器端口</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">    <span class="comment"># Redis服务器认证密码</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">    <span class="comment"># Redis数据库</span></span><br><span class="line">    <span class="attr">database:</span> <span class="number">0</span></span><br><span class="line">    <span class="comment"># 连接超时时间</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="string">10000ms</span></span><br><span class="line">    <span class="attr">lettuce:</span></span><br><span class="line">      <span class="attr">pool:</span></span><br><span class="line">        <span class="comment"># 最大连接数，默认8</span></span><br><span class="line">        <span class="attr">max-active:</span> <span class="number">1024</span></span><br><span class="line">        <span class="comment"># 最大阻塞等待时间，单位毫秒，默认-1ms</span></span><br><span class="line">        <span class="attr">max-wait:</span> <span class="string">10000ms</span></span><br><span class="line">        <span class="comment"># 最大空闲连接，默认8</span></span><br><span class="line">        <span class="attr">max-idle:</span> <span class="number">200</span></span><br><span class="line">        <span class="comment"># 最小空闲连接，默认0</span></span><br><span class="line">        <span class="attr">min-idle:</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>

<h2 id="7-4、测试环境是否搭建成功"><a href="#7-4、测试环境是否搭建成功" class="headerlink" title="7.4、测试环境是否搭建成功"></a>7.4、测试环境是否搭建成功</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringDataRedisDemoApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;    <span class="comment">// 默认模板</span></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">initConn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ValueOperations&lt;String,String&gt; ops = stringRedisTemplate.opsForValue();</span><br><span class="line">        ops.set(<span class="string">&quot;userName&quot;</span>,<span class="string">&quot;ahh&quot;</span>);</span><br><span class="line">        ValueOperations&lt;String,String&gt; value = redisTemplate.opsForValue();</span><br><span class="line">        value.set(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">        System.out.println(ops.get(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-5、序列化问题"><a href="#7-5、序列化问题" class="headerlink" title="7.5、序列化问题"></a>7.5、序列化问题</h2><p>上面的测试程序，虽然成功的把数据写入了，但是写入的是一个二进制字节码，需要处理一下。</p>
<p><code>RedisTemplate</code>使用的是<code>JdkSerializationRedisSerializer</code>进行序列化，会序列化为二进制字节码储存。这时需要自定义模板解决。当自定义模板后，又想储存String字符串可以使用<code>StringRedisTemplate</code>。自定义的模板和<code>StringRedisTemplate</code>不冲突。</p>
<p>序列化的选择：</p>
<ul>
<li><code>JdkSerializationRedisSerializer</code>：该序列化为<code>RedisTemplate</code>的默认序列化工具，是JDK提供的，有点是反序列化时不需要提供类型信息(class)，但是缺点就是序列化后的结果非常大，而且看不懂，时json格式的5倍左右，会消耗redis服务器的大量内存。</li>
<li><code>Jackson2JsonRedisSerializer</code>：使用的时<code>Jackson</code>库将对象序列化为json字符串，优点是速度快，序列化后的字符串短小精悍，但是缺点也非常致命，那就是此类的构造函数中有一个类型参数，必须提供要序列化对象的类型信息，通过查看源代码，发现其只再反序列化过程中用到了类型信息。</li>
<li><code>GenericJackson2JsonRedisSerializer</code>：通用型序列化，这种序列化方式不用自己手动指定对象的Class。</li>
</ul>
<p>自定义模板</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.yanghuisen.springdataredisdemo.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.lettuce.LettuceConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.GenericJackson2JsonRedisSerializer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.StringRedisSerializer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> admin</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/5/14 20:52</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span> 自定义模板</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;String,Object&gt; <span class="title">redisTemplate</span><span class="params">(LettuceConnectionFactory lettuceConnectionFactory)</span></span>&#123;</span><br><span class="line">        <span class="comment">// 创建模板</span></span><br><span class="line">        RedisTemplate&lt;String,Object&gt; redisTemplate = <span class="keyword">new</span> RedisTemplate&lt;&gt;();</span><br><span class="line">        <span class="comment">// 设置String类型的Key的序列器</span></span><br><span class="line">        redisTemplate.setKeySerializer(<span class="keyword">new</span> StringRedisSerializer());</span><br><span class="line">        <span class="comment">// 设置String类型的value的序列器</span></span><br><span class="line">        redisTemplate.setValueSerializer(<span class="keyword">new</span> GenericJackson2JsonRedisSerializer());</span><br><span class="line">        <span class="comment">// 设置Hash类型的Key的序列器</span></span><br><span class="line">        redisTemplate.setHashKeySerializer(<span class="keyword">new</span> StringRedisSerializer());</span><br><span class="line">        <span class="comment">// 设置hash类型的value的序列器</span></span><br><span class="line">        redisTemplate.setHashValueSerializer(<span class="keyword">new</span> GenericJackson2JsonRedisSerializer());</span><br><span class="line">        <span class="comment">// 设置连接方式</span></span><br><span class="line">        redisTemplate.setConnectionFactory(lettuceConnectionFactory);</span><br><span class="line">        <span class="keyword">return</span> redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>序列化测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testSerial</span><span class="params">()</span></span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setId(<span class="number">1</span>);</span><br><span class="line">    user.setName(<span class="string">&quot;ahh&quot;</span>);</span><br><span class="line">    ValueOperations ops = redisTemplate.opsForValue();</span><br><span class="line">    ops.set(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">    System.out.println(ops.get(<span class="string">&quot;user&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Ok</p>
<h2 id="7-6、操作String"><a href="#7-6、操作String" class="headerlink" title="7.6、操作String"></a>7.6、操作String</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testString</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ValueOperations vos = redisTemplate.opsForValue();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 添加一条数据</span></span><br><span class="line">    vos.set(<span class="string">&quot;userName&quot;</span>,<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">    <span class="comment">// 以层级关系|目录形式存储数据</span></span><br><span class="line">    vos.set(<span class="string">&quot;user:01&quot;</span>,<span class="string">&quot;ahh&quot;</span>);</span><br><span class="line">    <span class="comment">// 添加多条数据</span></span><br><span class="line">    Map&lt;String,String&gt; userMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    userMap.put(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;18&quot;</span>);</span><br><span class="line">    userMap.put(<span class="string">&quot;sex&quot;</span>,<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    vos.multiSet(userMap);</span><br><span class="line">    <span class="comment">// 获取一条数据</span></span><br><span class="line">    System.out.println(vos.get(<span class="string">&quot;userName&quot;</span>));</span><br><span class="line">    <span class="comment">// 获取多条数据</span></span><br><span class="line">    List&lt;String&gt; keys = Arrays.asList(<span class="string">&quot;userName&quot;</span>,<span class="string">&quot;age&quot;</span>,<span class="string">&quot;sex&quot;</span>);</span><br><span class="line">    vos.multiGet(keys).forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-7、操作Hash"><a href="#7-7、操作Hash" class="headerlink" title="7.7、操作Hash"></a>7.7、操作Hash</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testHash</span><span class="params">()</span></span>&#123;</span><br><span class="line">    HashOperations&lt;String,String,String&gt; hos = redisTemplate.opsForHash();</span><br><span class="line">    <span class="comment">// 添加一条数据</span></span><br><span class="line">    hos.put(<span class="string">&quot;userInfo&quot;</span>,<span class="string">&quot;name&quot;</span>,<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">    <span class="comment">// 添加多条数据</span></span><br><span class="line">    Map&lt;String,String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;20&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;sex&quot;</span>,<span class="string">&quot;男&quot;</span>);</span><br><span class="line">    hos.putAll(<span class="string">&quot;userInfo&quot;</span>,map);</span><br><span class="line">    <span class="comment">// 获取一条数据</span></span><br><span class="line">    System.out.println(hos.get(<span class="string">&quot;userInfo&quot;</span>,<span class="string">&quot;name&quot;</span>));</span><br><span class="line">    <span class="comment">// 获取多条数据</span></span><br><span class="line">    List&lt;String&gt; keys = Arrays.asList(<span class="string">&quot;age&quot;</span>,<span class="string">&quot;sex&quot;</span>);</span><br><span class="line">    hos.multiGet(<span class="string">&quot;userInfo&quot;</span>,keys).forEach(System.out::println);</span><br><span class="line">    <span class="comment">// 获取Hash类型的所有的数据</span></span><br><span class="line">    hos.entries(<span class="string">&quot;userInfo&quot;</span>).forEach((k,v)-&gt;&#123;</span><br><span class="line">        System.out.println(k+<span class="string">&quot;---&quot;</span>+v);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// 删除数据</span></span><br><span class="line">    hos.delete(<span class="string">&quot;userInfo&quot;</span>,<span class="string">&quot;name&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-8、操作List"><a href="#7-8、操作List" class="headerlink" title="7.8、操作List"></a>7.8、操作List</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testList</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ListOperations los = redisTemplate.opsForList();</span><br><span class="line">    <span class="comment">// 左添加</span></span><br><span class="line">    los.leftPush(<span class="string">&quot;students&quot;</span>,<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">    los.leftPush(<span class="string">&quot;students&quot;</span>,<span class="string">&quot;李四&quot;</span>);</span><br><span class="line">    <span class="comment">// 指定位置前面左添加</span></span><br><span class="line">    los.leftPush(<span class="string">&quot;students&quot;</span>,<span class="string">&quot;李四&quot;</span>,<span class="string">&quot;王五&quot;</span>);</span><br><span class="line">    <span class="comment">// 右添加</span></span><br><span class="line">    los.rightPush(<span class="string">&quot;students&quot;</span>,<span class="string">&quot;赵六&quot;</span>);</span><br><span class="line">    <span class="comment">// 获取</span></span><br><span class="line">    los.range(<span class="string">&quot;students&quot;</span>,<span class="number">1</span>,<span class="number">10</span>).forEach(System.out::println);</span><br><span class="line">    <span class="comment">// 根据下标获取</span></span><br><span class="line">    System.out.println(los.index(<span class="string">&quot;students&quot;</span>,<span class="number">1</span>));</span><br><span class="line">    <span class="comment">// 获取总条数</span></span><br><span class="line">    System.out.println(los.size(<span class="string">&quot;students&quot;</span>));</span><br><span class="line">    <span class="comment">// 删除单条数据</span></span><br><span class="line">    los.remove(<span class="string">&quot;students&quot;</span>,<span class="number">1</span>,<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-9、操作oSet"><a href="#7-9、操作oSet" class="headerlink" title="7.9、操作oSet"></a>7.9、操作oSet</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testSer</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SetOperations sos = redisTemplate.opsForSet();</span><br><span class="line">    <span class="comment">// 添加数据</span></span><br><span class="line">    sos.add(<span class="string">&quot;letters&quot;</span>,<span class="keyword">new</span> String[]&#123;<span class="string">&quot;aaa&quot;</span>,<span class="string">&quot;bbb&quot;</span>,<span class="string">&quot;ccc&quot;</span>,<span class="string">&quot;ddd&quot;</span>&#125;);</span><br><span class="line">    sos.members(<span class="string">&quot;letters&quot;</span>).forEach(System.out::println);</span><br><span class="line">    sos.remove(<span class="string">&quot;letters&quot;</span>,<span class="string">&quot;aaa&quot;</span>,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-10、操作SortedSet"><a href="#7-10、操作SortedSet" class="headerlink" title="7.10、操作SortedSet"></a>7.10、操作SortedSet</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testSoredSet</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ZSetOperations zsos = redisTemplate.opsForZSet();</span><br><span class="line">    <span class="comment">// 添加数据</span></span><br><span class="line">    zsos.add(<span class="string">&quot;score&quot;</span>,<span class="string">&quot;zhangsan&quot;</span>,<span class="number">5D</span>);</span><br><span class="line">    zsos.add(<span class="string">&quot;score&quot;</span>,<span class="string">&quot;lisi&quot;</span>,<span class="number">2D</span>);</span><br><span class="line">    zsos.add(<span class="string">&quot;score&quot;</span>,<span class="string">&quot;wangwu&quot;</span>,<span class="number">9D</span>);</span><br><span class="line">    zsos.add(<span class="string">&quot;score&quot;</span>,<span class="string">&quot;zhaoliu&quot;</span>,<span class="number">3D</span>);</span><br><span class="line">    <span class="comment">// 获取</span></span><br><span class="line">    zsos.range(<span class="string">&quot;score&quot;</span>,<span class="number">0</span>,<span class="number">5</span>).forEach(System.out::println);</span><br><span class="line">    <span class="comment">// 获取总条数</span></span><br><span class="line">    System.out.println(zsos.size(<span class="string">&quot;score&quot;</span>));</span><br><span class="line">    <span class="comment">// 删除</span></span><br><span class="line">    zsos.remove(<span class="string">&quot;score&quot;</span>,<span class="string">&quot;wangwu&quot;</span>,<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-11、获取所有的Key"><a href="#7-11、获取所有的Key" class="headerlink" title="7.11、获取所有的Key"></a>7.11、获取所有的Key</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testAllKeys</span><span class="params">()</span></span>&#123;</span><br><span class="line">    redisTemplate.keys(<span class="string">&quot;*&quot;</span>).forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-12、删除"><a href="#7-12、删除" class="headerlink" title="7.12、删除"></a>7.12、删除</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">// 删除</span></span><br><span class="line">    redisTemplate.delete(<span class="string">&quot;score&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-13、设置Key的失效时间"><a href="#7-13、设置Key的失效时间" class="headerlink" title="7.13、设置Key的失效时间"></a>7.13、设置Key的失效时间</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testEx</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ValueOperations vos = redisTemplate.opsForValue();</span><br><span class="line">    <span class="comment">// 添加一条数据，并设置失效时间</span></span><br><span class="line">    vos.set(<span class="string">&quot;code&quot;</span>,<span class="string">&quot;abcd&quot;</span>,<span class="number">180</span>, TimeUnit.SECONDS);</span><br><span class="line">    <span class="comment">// 给已经存在的key设置失效时间</span></span><br><span class="line">    redisTemplate.expire(<span class="string">&quot;code&quot;</span>,<span class="number">180</span>,TimeUnit.SECONDS);</span><br><span class="line">    <span class="comment">// 获取指定key的失效时间</span></span><br><span class="line">    System.out.println(redisTemplate.getExpire(<span class="string">&quot;code&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-14、整合使用哨兵机制"><a href="#7-14、整合使用哨兵机制" class="headerlink" title="7.14、整合使用哨兵机制"></a>7.14、整合使用哨兵机制</h2><p>配置文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="comment"># Redis服务器地址</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.10</span><span class="number">.100</span></span><br><span class="line">    <span class="comment"># Redis服务器端口</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6380</span></span><br><span class="line">    <span class="comment"># Redis服务器认证密码</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">    <span class="comment"># Redis数据库</span></span><br><span class="line">    <span class="attr">database:</span> <span class="number">0</span></span><br><span class="line">    <span class="comment"># 连接超时时间</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="string">10000ms</span></span><br><span class="line">    <span class="attr">lettuce:</span></span><br><span class="line">      <span class="attr">pool:</span></span><br><span class="line">        <span class="comment"># 最大连接数，默认8</span></span><br><span class="line">        <span class="attr">max-active:</span> <span class="number">1024</span></span><br><span class="line">        <span class="comment"># 最大阻塞等待时间，单位毫秒，默认-1ms</span></span><br><span class="line">        <span class="attr">max-wait:</span> <span class="string">10000ms</span></span><br><span class="line">        <span class="comment"># 最大空闲连接，默认8</span></span><br><span class="line">        <span class="attr">max-idle:</span> <span class="number">200</span></span><br><span class="line">        <span class="comment"># 最小空闲连接，默认0</span></span><br><span class="line">        <span class="attr">min-idle:</span> <span class="number">5</span></span><br><span class="line">    <span class="comment"># 哨兵模式</span></span><br><span class="line">    <span class="attr">sentinel:</span></span><br><span class="line">      <span class="comment"># 主节点</span></span><br><span class="line">      <span class="attr">master:</span> <span class="string">mymaster</span></span><br><span class="line">      <span class="attr">nodes:</span> <span class="number">192.168</span><span class="number">.10</span><span class="number">.100</span><span class="string">:26379,192.168.10.100:26380,192.168.10.100:26381</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>配置类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function">RedisSentinelConfiguration <span class="title">redisSentinelConfiguration</span><span class="params">()</span></span>&#123;</span><br><span class="line">    RedisSentinelConfiguration sentinelConfiguration = <span class="keyword">new</span> RedisSentinelConfiguration().</span><br><span class="line">        <span class="comment">// 主节点名称</span></span><br><span class="line">        master(<span class="string">&quot;mymaster&quot;</span>)</span><br><span class="line">        <span class="comment">// 服务器地址</span></span><br><span class="line">        .sentinel(<span class="string">&quot;192.168.10.100&quot;</span>,<span class="number">26379</span>)</span><br><span class="line">        .sentinel(<span class="string">&quot;192.168.10.100&quot;</span>,<span class="number">26380</span>)</span><br><span class="line">        .sentinel(<span class="string">&quot;192.168.10.100&quot;</span>,<span class="number">26381</span>);</span><br><span class="line">    <span class="comment">// 设置密码</span></span><br><span class="line">    sentinelConfiguration.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> sentinelConfiguration;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">YANG</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.yanghuisen.cn/2020/05/14/Redis%E7%9A%84%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8/">http://www.yanghuisen.cn/2020/05/14/Redis的入门使用/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.yanghuisen.cn" target="_blank">Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/Redis/">Redis</a></div><div class="post_share"><div class="social-share" data-image="/img/index_img2.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/04/01/FreeMarker%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"><img class="prev-cover" src="/img/index_img2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">FreeMarker的简单使用</div></div></a></div><div class="next-post pull-right"><a href="/2020/05/30/RabbitMQ%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E7%9A%84%E5%85%A5%E9%97%A8%E4%BD%BF%E7%94%A8/"><img class="next-cover" src="/img/index_img3.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">RabbitMQ消息队列的入门使用</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/06/13/Arrays-asList-%E7%9C%9F%E7%9A%84%E5%B0%B1%E6%8A%8A%E6%95%B0%E7%BB%84%E8%BD%AC%E6%8D%A2%E4%B8%BA%E4%BA%86List%E9%9B%86%E5%90%88%E5%90%97/" title="Arrays.asList()真的就把数组转换为了List集合吗?"><img class="cover" src="/img/index_img4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-13</div><div class="title">Arrays.asList()真的就把数组转换为了List集合吗?</div></div></a></div><div><a href="/2020/06/13/Java%E7%9A%84%E6%B3%A8%E9%87%8A%E7%9C%9F%E7%9A%84%E4%B8%8D%E4%BC%9A%E8%A2%AB%E6%89%A7%E8%A1%8C%E5%90%97/" title="Java的注释真的不会被执行吗?"><img class="cover" src="/img/index_img1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-13</div><div class="title">Java的注释真的不会被执行吗?</div></div></a></div><div><a href="/2020/07/03/%E4%BA%8C-SpringCloud%E4%B9%8BRibbon%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" title="(二)SpringCloud之Ribbon负载均衡"><img class="cover" src="/img/index_img1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-03</div><div class="title">(二)SpringCloud之Ribbon负载均衡</div></div></a></div><div><a href="/2020/06/17/%E6%B7%BB%E5%8A%A0Eureka%E4%BE%9D%E8%B5%96%E5%90%8E%E8%BF%94%E5%9B%9EXML%E8%80%8C%E4%B8%8D%E6%98%AFJSON%E6%95%B0%E6%8D%AE/" title="添加Eureka依赖后返回XML而不是JSON数据"><img class="cover" src="/img/index_img2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-17</div><div class="title">添加Eureka依赖后返回XML而不是JSON数据</div></div></a></div><div><a href="/2020/04/01/FreeMarker%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/" title="FreeMarker的简单使用"><img class="cover" src="/img/index_img2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-01</div><div class="title">FreeMarker的简单使用</div></div></a></div><div><a href="/2020/07/03/%E4%B8%89-SpringCloud%E4%B9%8BConsul%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83/" title="(三)SpringCloud之Consul注册中心"><img class="cover" src="/img/index_img1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-03</div><div class="title">(三)SpringCloud之Consul注册中心</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">YANG</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">28</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">25</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Ys2025"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Ys2025" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="https://blog.csdn.net/Asdzxc968" target="_blank" title="CSDN"><i class="fas fa-blog"></i></a><a class="social-icon" href="mailto:admin@yanghuisen.cn" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0%E3%80%81Redis"><span class="toc-number">1.</span> <span class="toc-text">0、Redis</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1%E3%80%81Linux%E4%B8%8B%E7%9A%84Redis%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">1、Linux下的Redis的安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1%E3%80%81%E4%B8%8B%E8%BD%BD"><span class="toc-number">2.1.</span> <span class="toc-text">1.1、下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2%E3%80%81%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">2.2.</span> <span class="toc-text">1.2、上传文件到服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3%E3%80%81%E8%A7%A3%E5%8E%8B%E6%96%87%E4%BB%B6"><span class="toc-number">2.3.</span> <span class="toc-text">1.3、解压文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4%E3%80%81%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96"><span class="toc-number">2.4.</span> <span class="toc-text">1.4、安装依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5%E3%80%81%E9%A2%84%E7%BC%96%E8%AF%91"><span class="toc-number">2.5.</span> <span class="toc-text">1.5、预编译</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-6%E3%80%81%E5%AE%89%E8%A3%85"><span class="toc-number">2.6.</span> <span class="toc-text">1.6、安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-7%E3%80%81%E5%89%8D%E5%8F%B0%E5%90%AF%E5%8A%A8"><span class="toc-number">2.7.</span> <span class="toc-text">1.7、前台启动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-8%E3%80%81%E5%90%8E%E5%8F%B0%E5%90%AF%E5%8A%A8"><span class="toc-number">2.8.</span> <span class="toc-text">1.8、后台启动</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2%E3%80%81windows%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%96%B9%E6%B3%95Redis"><span class="toc-number">3.</span> <span class="toc-text">2、windows客户端方法Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1%E3%80%81%E5%AE%89%E8%A3%85%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BD%AF%E4%BB%B6"><span class="toc-number">3.1.</span> <span class="toc-text">2.1、安装客户端软件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2%E3%80%81%E9%85%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AFRedis%E7%A8%8B%E5%BA%8F"><span class="toc-number">3.2.</span> <span class="toc-text">2.2、配置服务器端Redis程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3%E3%80%81windows%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5redis"><span class="toc-number">3.3.</span> <span class="toc-text">2.3、windows客户端连接redis</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3%E3%80%81Redis-cli%E8%BF%9E%E6%8E%A5%E6%93%8D%E4%BD%9CRedis"><span class="toc-number">4.</span> <span class="toc-text">3、Redis-cli连接操作Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1%E3%80%81redis-clid%E8%BF%9E%E6%8E%A5redis"><span class="toc-number">4.1.</span> <span class="toc-text">3.1、redis-clid连接redis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2%E3%80%81%E6%93%8D%E4%BD%9Credis"><span class="toc-number">4.2.</span> <span class="toc-text">3.2、操作redis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1%E3%80%81String%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.2.1.</span> <span class="toc-text">3.2.1、String类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2%E3%80%81Hash%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.2.2.</span> <span class="toc-text">3.2.2、Hash类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-3%E3%80%81List%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.2.3.</span> <span class="toc-text">3.2.3、List类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-4%E3%80%81Set%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.2.4.</span> <span class="toc-text">3.2.4、Set类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-5%E3%80%81Sorted-Set%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.2.5.</span> <span class="toc-text">3.2.5、Sorted Set类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-6%E3%80%81%E5%B1%82%E7%BA%A7%E5%85%B3%E7%B3%BB-%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">4.2.6.</span> <span class="toc-text">3.2.6、层级关系|目录结构存储数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-7%E3%80%81%E8%AE%BE%E7%BD%AEKey%E7%9A%84%E5%A4%B1%E6%95%88%E6%97%B6%E9%97%B4"><span class="toc-number">4.2.7.</span> <span class="toc-text">3.2.7、设置Key的失效时间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-8%E3%80%81%E5%88%A0%E9%99%A4"><span class="toc-number">4.2.8.</span> <span class="toc-text">3.2.8、删除</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4%E3%80%81Redis%E6%8C%81%E4%B9%85%E5%8C%96%E5%82%A8%E5%AD%98"><span class="toc-number">5.</span> <span class="toc-text">4、Redis持久化储存</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1%E3%80%81bgsave"><span class="toc-number">5.1.</span> <span class="toc-text">4.1、bgsave</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2%E3%80%81save%E9%85%8D%E7%BD%AE"><span class="toc-number">5.2.</span> <span class="toc-text">4.2、save配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3%E3%80%81appendonly"><span class="toc-number">5.3.</span> <span class="toc-text">4.3、appendonly</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5%E3%80%81Java%E6%93%8D%E4%BD%9CRedis"><span class="toc-number">6.</span> <span class="toc-text">5、Java操作Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1%E3%80%81%E5%88%9B%E5%BB%BASpringBoot%E9%A1%B9%E7%9B%AE"><span class="toc-number">6.1.</span> <span class="toc-text">5.1、创建SpringBoot项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2%E3%80%81%E4%BF%AE%E6%94%B9POM%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">6.2.</span> <span class="toc-text">5.2、修改POM配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3%E3%80%81Jedis%E7%9A%84%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">6.3.</span> <span class="toc-text">5.3、Jedis的的配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4%E3%80%81%E5%88%9B%E5%BB%BA%E8%BF%9E%E6%8E%A5%E6%B1%A0%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-number">6.4.</span> <span class="toc-text">5.4、创建连接池配置类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5%E3%80%81%E6%B3%A8%E5%85%A5%E8%BF%9E%E6%8E%A5%E6%B1%A0%EF%BC%8C%E5%88%87%E5%85%A5%E7%82%B9%E6%8B%A6%E6%88%AA"><span class="toc-number">6.5.</span> <span class="toc-text">5.5、注入连接池，切入点拦截</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5%E3%80%81%E6%93%8D%E4%BD%9CString"><span class="toc-number">6.6.</span> <span class="toc-text">5.5、操作String</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6%E3%80%81%E6%93%8D%E4%BD%9CHash"><span class="toc-number">6.7.</span> <span class="toc-text">5.6、操作Hash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-7%E3%80%81%E6%93%8D%E4%BD%9CList"><span class="toc-number">6.8.</span> <span class="toc-text">5.7、操作List</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-8%E3%80%81%E6%93%8D%E4%BD%9CSet"><span class="toc-number">6.9.</span> <span class="toc-text">5.8、操作Set</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-9%E3%80%81%E6%93%8D%E4%BD%9CSorted-Set"><span class="toc-number">6.10.</span> <span class="toc-text">5.9、操作Sorted Set</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-10%E3%80%81%E5%B1%82%E7%BA%A7%E5%85%B3%E7%B3%BB-%E7%9B%AE%E5%BD%95%E5%BD%A2%E5%BC%8F%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">6.11.</span> <span class="toc-text">5.10、层级关系|目录形式存储数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-11%E3%80%81%E8%AE%BE%E7%BD%AE%E5%A4%B1%E6%95%88%E6%97%B6%E9%97%B4"><span class="toc-number">6.12.</span> <span class="toc-text">5.11、设置失效时间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-12%E3%80%81%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E7%9A%84key"><span class="toc-number">6.13.</span> <span class="toc-text">5.12、获取所有的key</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-13%E3%80%81%E5%88%A0%E9%99%A4"><span class="toc-number">6.14.</span> <span class="toc-text">5.13、删除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-14%E3%80%81%E4%BA%8B%E5%8A%A1"><span class="toc-number">6.15.</span> <span class="toc-text">5.14、事务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-15%E3%80%81byte%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">6.16.</span> <span class="toc-text">5.15、byte序列化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6%E3%80%81Redis%E6%90%AD%E5%BB%BA%E4%B8%BB%E4%BB%8E%E5%A4%8D%E7%94%A8"><span class="toc-number">7.</span> <span class="toc-text">6、Redis搭建主从复用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1%E3%80%81%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB"><span class="toc-number">7.1.</span> <span class="toc-text">6.1、读写分离</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2%E3%80%81%E5%88%9B%E5%BB%BA%E9%85%8D%E7%BD%AE%E4%B8%89%E4%B8%AA%E7%A7%81%E6%9C%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">7.2.</span> <span class="toc-text">6.2、创建配置三个私有配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3%E3%80%81%E8%BF%90%E8%A1%8C%E4%B8%89%E4%B8%AAredis%E8%BF%9B%E7%A8%8B%EF%BC%8C%E5%B9%B6%E6%B5%8B%E8%AF%95%E4%B8%BB%E4%BB%8E"><span class="toc-number">7.3.</span> <span class="toc-text">6.3、运行三个redis进程，并测试主从</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4%E3%80%81%E4%B8%BB%E5%A4%87%E5%88%87%E6%8D%A2"><span class="toc-number">7.4.</span> <span class="toc-text">6.4、主备切换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-1%E3%80%81%E5%A4%8D%E5%88%B6%E5%93%A8%E5%85%B5%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%88%B0%E5%88%9B%E5%BB%BA%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E4%B8%8B"><span class="toc-number">7.4.1.</span> <span class="toc-text">6.4.1、复制哨兵配置文件到创建的配置文件目录下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-2%E3%80%81%E4%BF%AE%E6%94%B9%E5%93%A8%E5%85%B5%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">7.4.2.</span> <span class="toc-text">6.4.2、修改哨兵配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-3%E3%80%81%E6%B7%BB%E5%8A%A0%E4%B8%89%E4%B8%AA%E7%A7%81%E6%9C%89%E5%93%A8%E5%85%B5%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">7.4.3.</span> <span class="toc-text">6.4.3、添加三个私有哨兵配置文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-4%E3%80%81%E5%93%A8%E5%85%B5%E5%90%AF%E5%8A%A8%E6%B5%8B%E8%AF%95"><span class="toc-number">7.5.</span> <span class="toc-text">6.4.4、哨兵启动测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7%E3%80%81SpringDataRedis"><span class="toc-number">8.</span> <span class="toc-text">7、SpringDataRedis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1%E3%80%81%E5%88%9B%E5%BB%BASpringBoot%E9%A1%B9%E7%9B%AE"><span class="toc-number">8.1.</span> <span class="toc-text">7.1、创建SpringBoot项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2%E3%80%81%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96"><span class="toc-number">8.2.</span> <span class="toc-text">7.2、添加依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3%E3%80%81%E6%B7%BB%E5%8A%A0application-yml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">8.3.</span> <span class="toc-text">7.3、添加application.yml配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4%E3%80%81%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%E6%98%AF%E5%90%A6%E6%90%AD%E5%BB%BA%E6%88%90%E5%8A%9F"><span class="toc-number">8.4.</span> <span class="toc-text">7.4、测试环境是否搭建成功</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-5%E3%80%81%E5%BA%8F%E5%88%97%E5%8C%96%E9%97%AE%E9%A2%98"><span class="toc-number">8.5.</span> <span class="toc-text">7.5、序列化问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-6%E3%80%81%E6%93%8D%E4%BD%9CString"><span class="toc-number">8.6.</span> <span class="toc-text">7.6、操作String</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-7%E3%80%81%E6%93%8D%E4%BD%9CHash"><span class="toc-number">8.7.</span> <span class="toc-text">7.7、操作Hash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-8%E3%80%81%E6%93%8D%E4%BD%9CList"><span class="toc-number">8.8.</span> <span class="toc-text">7.8、操作List</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-9%E3%80%81%E6%93%8D%E4%BD%9CoSet"><span class="toc-number">8.9.</span> <span class="toc-text">7.9、操作oSet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-10%E3%80%81%E6%93%8D%E4%BD%9CSortedSet"><span class="toc-number">8.10.</span> <span class="toc-text">7.10、操作SortedSet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-11%E3%80%81%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E7%9A%84Key"><span class="toc-number">8.11.</span> <span class="toc-text">7.11、获取所有的Key</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-12%E3%80%81%E5%88%A0%E9%99%A4"><span class="toc-number">8.12.</span> <span class="toc-text">7.12、删除</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-13%E3%80%81%E8%AE%BE%E7%BD%AEKey%E7%9A%84%E5%A4%B1%E6%95%88%E6%97%B6%E9%97%B4"><span class="toc-number">8.13.</span> <span class="toc-text">7.13、设置Key的失效时间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-14%E3%80%81%E6%95%B4%E5%90%88%E4%BD%BF%E7%94%A8%E5%93%A8%E5%85%B5%E6%9C%BA%E5%88%B6"><span class="toc-number">8.14.</span> <span class="toc-text">7.14、整合使用哨兵机制</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/01/06/Oracle%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/" title="Oracle问题记录"><img src="/img/index_img4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Oracle问题记录"/></a><div class="content"><a class="title" href="/2023/01/06/Oracle%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/" title="Oracle问题记录">Oracle问题记录</a><time datetime="2023-01-06T01:36:04.000Z" title="发表于 2023-01-06 09:36:04">2023-01-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/11/OracleHWM/" title="Oracle High Water Mark问题"><img src="/img/index_img4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Oracle High Water Mark问题"/></a><div class="content"><a class="title" href="/2022/12/11/OracleHWM/" title="Oracle High Water Mark问题">Oracle High Water Mark问题</a><time datetime="2022-12-11T08:07:04.000Z" title="发表于 2022-12-11 16:07:04">2022-12-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/04/%E4%BF%9D%E5%A7%86%E7%BA%A7%E5%BE%AE%E4%BF%A1%E5%8F%8C%E5%BC%80%E6%95%99%E7%A8%8B/" title="保姆级微信双开教程"><img src="/img/index_img3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="保姆级微信双开教程"/></a><div class="content"><a class="title" href="/2022/12/04/%E4%BF%9D%E5%A7%86%E7%BA%A7%E5%BE%AE%E4%BF%A1%E5%8F%8C%E5%BC%80%E6%95%99%E7%A8%8B/" title="保姆级微信双开教程">保姆级微信双开教程</a><time datetime="2022-12-03T17:37:00.000Z" title="发表于 2022-12-04 01:37:00">2022-12-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/25/%E4%BD%BF%E7%94%A8XShell%E8%BF%9E%E6%8E%A5Vm%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%AD%E5%AE%89%E8%A3%85%E7%9A%84Centos/" title="使用XShell连接Vm虚拟机中安装的Centos"><img src="/img/index_img1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用XShell连接Vm虚拟机中安装的Centos"/></a><div class="content"><a class="title" href="/2021/12/25/%E4%BD%BF%E7%94%A8XShell%E8%BF%9E%E6%8E%A5Vm%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%AD%E5%AE%89%E8%A3%85%E7%9A%84Centos/" title="使用XShell连接Vm虚拟机中安装的Centos">使用XShell连接Vm虚拟机中安装的Centos</a><time datetime="2021-12-25T07:59:38.000Z" title="发表于 2021-12-25 15:59:38">2021-12-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/25/%E4%BD%BF%E7%94%A8XShell%E8%BF%9E%E6%8E%A5Vm%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%AD%E5%AE%89%E8%A3%85%E7%9A%84UbuntuServer20-04/" title="使用XShell连接Vm虚拟机中安装的UbuntuServer20.04"><img src="/img/index_img4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用XShell连接Vm虚拟机中安装的UbuntuServer20.04"/></a><div class="content"><a class="title" href="/2021/12/25/%E4%BD%BF%E7%94%A8XShell%E8%BF%9E%E6%8E%A5Vm%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%AD%E5%AE%89%E8%A3%85%E7%9A%84UbuntuServer20-04/" title="使用XShell连接Vm虚拟机中安装的UbuntuServer20.04">使用XShell连接Vm虚拟机中安装的UbuntuServer20.04</a><time datetime="2021-12-25T07:59:04.000Z" title="发表于 2021-12-25 15:59:04">2021-12-25</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/index_img2.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2023 By YANG</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://www.yanghuisen.cn/">blog</a><br/><a target="_blank" rel="noopener" href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral">本网站由<img class="icp-icon" src="/img/ypy.png">提供CDN加速/云存储服务</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>